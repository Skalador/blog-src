{:title "Openshift 4.x and Service Mesh - 1" 
 :layout 
 :post 
 :tags ["Istio", "Service Mesh", "OpenShift", "OCP"] 
 :toc true 
}

// Asciidoc Parameters
:author: Thomas Jungbauer
:icons: font
:linkattrs:

_Author: {author} - Last Modified: {docdatetime}_
// Asciidoc Parameters END

== Introduction
The following tutorials for OpenShift Service Mesh are based on the official OpenShift 4.3 documentation: https://docs.openshift.com/container-platform/4.3/service_mesh/servicemesh-release-notes.html[OpenShift 4.3 Service Mesh^]. Currently OpenShift supports Istio 1.1.17, which shall be updated in one of the future releases. 

To learn the basics of Service Mesh, please consult the documentation as they are not repeated here. 

== Prerequisites
At the very beginning OpenShift must be installed. This tutorial is based on OpenShift 4.3 and a Lab installation on Hetzner was used. 
Moreover, it is assumed that https://mirror.openshift.com/pub/openshift-v4/clients/oc/4.3/[OpenShift^] Client and Git are installed on the local system.  

During the tutorials an example application in the namespace _tutorial_ will be deployed. This application will contain 3 microservers:

* customer (the entry point)
* preference
* recommendation

This application is also used at the https://learn.openshift.com/servicemesh[Interactive Learning Portal^] which is using OpenShift 3.

== Install Red Hat Service Mesh
To deploy Service Mesh on Openshift 4 follow the guide at https://docs.openshift.com/container-platform/4.3/service_mesh/service_mesh_install/installing-ossm.html[Installing Red Hat OpenShift Service Mesh^]
In short multiple operators must be installed: 

* Elasticsearch
* Jaeger
* Kiali
* Service Mesh 

== Link Jaeger and Grafana to Kiali
If Kiali is not able to auto detect Grafana and Jaeger, add the following line to kiali specification at:

[source,yaml]
----
oc edit ServiceMeshControlPlane -n istio-system

     kiali:  # ADD THE FOLLOWING LINES 
       dashboard:
         grafanaURL: https://grafana-istio-system.apps.<your clustername>
         jaegerURL: https://jaeger-istio-system.apps.<your clustername>
----